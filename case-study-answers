Q1) What is the total amount each customer spent at the restaurant?
  
  SELECT s.customer_id, SUM(m.price) AS total_spent
  FROM sales s
  JOIN menu m ON s.product_id = m.product_id
  GROUP BY s.customer_id
  ORDER BY s.customer_id;


Q2) How many days has each customer visited the restaurant?

  SELECT customer_id, COUNT(DISTINCT order_date) AS visit_days
  FROM sales
  GROUP BY customer_id
  ORDER BY customer_id;


Q3) What was the first item from the menu purchased by each customer?
  
  SELECT s.customer_id, MIN(s.order_date) AS first_date, m.product_name
  FROM sales s
  JOIN menu m ON s.product_id = m.product_id
  WHERE s.order_date = (
      SELECT MIN(order_date)
      FROM sales
      WHERE customer_id = s.customer_id
  )
  GROUP BY s.customer_id, m.product_name;


Q4) What is the most purchased item on the menu and how many times was it purchased by all customers?
  
  SELECT m.product_name, COUNT(*) AS total_orders
  FROM sales s
  JOIN menu m ON s.product_id = m.product_id
  GROUP BY m.product_name
  ORDER BY total_orders DESC
  LIMIT 1;


Q5) Which item was the most popular for each customer?
  
  SELECT s.customer_id, m.product_name, COUNT(*) AS item_count
  FROM sales s
  JOIN menu m ON s.product_id = m.product_id
  GROUP BY s.customer_id, m.product_name
  HAVING item_count = (
      SELECT MAX(cnt)
      FROM (
          SELECT COUNT(*) AS cnt
          FROM sales s2
          WHERE s2.customer_id = s.customer_id
          GROUP BY s2.product_id
      ) AS sub
  )
  ORDER BY s.customer_id;

  
Q6) Which item was purchased first by the customer after they became a member?
Q7) Which item was purchased just before the customer became a member?
Q8) What is the total items and amount spent for each member before they became a member?
Q9) If each $1 spent equates to 10 points and sushi has a 2x points multiplier - how many points would each customer have?
Q10) In the first week after a customer joins the program (including their join date) they earn 2x points on all items, not just sushi - how many points do customer A and B have at the end of January?
